# Commit To Ship

Commit To Ship is a consent-based accountability platform for Web3 builders.

It supports two commitment types:

- `personal`: a creator locks their own SOL into an escrow address, with a deadline and a success/failure outcome.
- `creator_reward`: a creator commits earned dev rewards (SOL) into an escrow address and locks releases behind milestones.

Important safety model (intentional):

- The platform does **not** take custody of creator wallets.
- The platform does **not** intercept fees or drain funds.
- Funding happens only when the creator redirects rewards to the escrow address or transfers SOL manually.

## How creator rewards work (MVP)

- A reward commitment generates an escrow address.
- The creator defines milestones (title + unlock amount) at commitment creation.
- The creator marks a milestone complete (signed message).
- Token holders can signal approval (signed message). If a `tokenMint` is set, only holders of that SPL mint can signal.
- After a time delay and approval threshold, a milestone becomes claimable.
- Admin releases the milestone by submitting an explicit on-chain transfer from escrow to the creator wallet.

## Repo structure

- `app` (Next.js app + API routes)

## Prerequisites

- Node.js 18+ and npm
- A Postgres database (`DATABASE_URL`) for commitment storage
- A Solana RPC URL (`SOLANA_RPC_URL`, optional)

## Local dev

1) Copy env vars:

- Copy `./.env.example` to `./app/.env.local`

2) Install deps + run:

```bash
cd app
npm install
npm run dev
```

## Key environment variables

- `DATABASE_URL`: Postgres connection string (required)
- `SOLANA_RPC_URL`: RPC endpoint (default: mainnet-beta public RPC)
- `SOLANA_COMMITMENT`: server-side commitment for reads/confirmations (`confirmed` recommended for beta, `finalized` for stricter finality)
- `ADMIN_WALLET_PUBKEYS`: comma-separated list of allowed admin wallet pubkeys (enables admin-only actions like release/resolve)
- `APP_ORIGIN`: optional; if set, admin endpoints require a matching `Origin` header
- `REWARD_CLAIM_DELAY_SECONDS`: delay after completion before a milestone can become claimable
- `REWARD_APPROVAL_THRESHOLD`: number of approval signals required
- `JUPITER_PRICE_CACHE_TTL_SECONDS`: cache TTL for Jupiter price fetches used in voting (seconds)

## Custody disclosure (MVP)

Escrow addresses are generated by the platform. For admin releases, the platform uses the escrow secret key stored server-side.
